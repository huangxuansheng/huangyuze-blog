import{_ as s,r as a,o as r,c as v,d as e,e as i,f as d,b as l}from"./app-VnZbzlub.js";const t={},c=e("h1",{id:"microappå¾®å‰ç«¯æ¡†æ¶",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#microappå¾®å‰ç«¯æ¡†æ¶","aria-hidden":"true"},"#"),i(" MicroAppå¾®å‰ç«¯æ¡†æ¶")],-1),u={href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fmicro-zoe%2Fmicro-app-demo",target:"_blank",rel:"noopener noreferrer"},m=l(`<h1 id="å¾®å‰ç«¯" tabindex="-1"><a class="header-anchor" href="#å¾®å‰ç«¯" aria-hidden="true">#</a> å¾®å‰ç«¯</h1><p>å¾®å‰ç«¯æ˜¯ä¸€ç§ç±»ä¼¼äºå¾®æœåŠ¡çš„æ¶æ„ï¼Œå®ƒå°†å¾®æœåŠ¡çš„ç†å¿µåº”ç”¨äºæµè§ˆå™¨ç«¯ï¼Œå³å°† Web åº”ç”¨ç”±å•ä¸€çš„å•ä½“åº”ç”¨è½¬å˜ä¸ºå¤šä¸ªå°å‹å‰ç«¯åº”ç”¨èšåˆä¸ºä¸€çš„åº”ç”¨ã€‚å„ä¸ªå‰ç«¯åº”ç”¨è¿˜å¯ä»¥ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹éƒ¨ç½²ã€‚å¾®å‰ç«¯æ¶æ„ä¸æ¡†æ¶æ— å…³ï¼Œæ¯ä¸ªå¾®åº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ¡†æ¶ã€‚</p><h1 id="microapp" tabindex="-1"><a class="header-anchor" href="#microapp" aria-hidden="true">#</a> MicroApp</h1><blockquote><p>MicroAppå€Ÿé‰´äº†WebComponentçš„æ€æƒ³ï¼Œé€šè¿‡CustomElementç»“åˆè‡ªå®šä¹‰çš„ShadowDomï¼Œå°†å¾®å‰ç«¯å°è£…æˆä¸€ä¸ªç±»WebComponentç»„ä»¶ï¼Œä»è€Œå®ç°å¾®å‰ç«¯çš„ç»„ä»¶åŒ–æ¸²æŸ“ã€‚å¹¶ä¸”ç”±äºè‡ªå®šä¹‰ShadowDomçš„éš”ç¦»ç‰¹æ€§ï¼Œmicro-appä¸éœ€è¦åƒsingle-spaä¸€æ ·è¦æ±‚å­åº”ç”¨ä¿®æ”¹æ¸²æŸ“é€»è¾‘å¹¶æš´éœ²å‡ºæ–¹æ³•ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹webpacké…ç½®ï¼Œæ˜¯ç›®å‰å¸‚é¢ä¸Šæ¥å…¥å¾®å‰ç«¯æˆæœ¬æœ€ä½çš„æ–¹æ¡ˆä¹‹ä¸€ã€‚ -- ã€ŠMicroAppã€‹</p></blockquote><p>MicroApp çš„æ¥å…¥æˆæœ¬ä½ã€å…¼å®¹æ€§é«˜ã€æ€§èƒ½å¼ºæ˜¯æˆ‘ä»¬é€‰æ‹©MicroAppä½œä¸ºå¾®å‰ç«¯æ¡†æ¶ä½¿ç”¨çš„é‡è¦å› ç´ ~</p><h1 id="å¿«é€Ÿå¼€å§‹" tabindex="-1"><a class="header-anchor" href="#å¿«é€Ÿå¼€å§‹" aria-hidden="true">#</a> å¿«é€Ÿå¼€å§‹</h1><h2 id="ä¸»åº”ç”¨-react" tabindex="-1"><a class="header-anchor" href="#ä¸»åº”ç”¨-react" aria-hidden="true">#</a> ä¸»åº”ç”¨ - react</h2><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fde3f2cf51dc460aa75de3deebbfaeb9~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt="demoæ¶æ„.png"></p><h3 id="_1-é¡¹ç›®å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_1-é¡¹ç›®å‡†å¤‡" aria-hidden="true">#</a> 1. é¡¹ç›®å‡†å¤‡</h3><p><strong>1. åˆ›å»ºé¡¹ç›®</strong></p><ol><li>åˆ›å»ºä¸»åº”ç”¨é¡¹ç›®ï¼š<code>npx create-react-app react18</code></li><li>åˆ›å»ºå­åº”ç”¨é¡¹ç›®-reactï¼š<code>npx create-react-app react18</code></li><li>åˆ›å»ºå­åº”ç”¨é¡¹ç›®-vue3ï¼š<code>vue create vue3</code></li></ol><p><strong>2. å®‰è£…ç›¸å…³ä¾èµ–</strong></p><ol><li>ã€ä¸»åº”ç”¨ã€‘å®‰è£…å¾®å‰ç«¯æ¡†æ¶ï¼š <code>npm i @micro-zoe/micro-app --save</code></li><li>ã€ä¸»åº”ç”¨ã€‘å®‰è£…è·¯ç”±ä¾èµ–ï¼š<code>npm i react-router-dom</code></li><li>ã€å­åº”ç”¨-reactã€‘å®‰è£…è·¯ç”±ä¾èµ–ï¼š<code>npm i react-router-dom</code></li><li>ã€å­åº”ç”¨-reactã€‘å®‰è£…è·¨åŸŸè§£å†³æ”¯æŒä¾èµ–ï¼š<code>npm install react-app-rewired customize-cra --save-dev</code></li><li>ã€å­åº”ç”¨-vue3ã€‘å®‰è£…è·¯ç”±ä¾èµ–ï¼š<code>npm install vue-router</code></li></ol><h3 id="_2-æ­å»ºç›¸å…³è·¯ç”±ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_2-æ­å»ºç›¸å…³è·¯ç”±ç³»ç»Ÿ" aria-hidden="true">#</a> 2. æ­å»ºç›¸å…³è·¯ç”±ç³»ç»Ÿ</h3><ol><li><p>ã€ä¸»åº”ç”¨ã€‘è·¯ç”±ç³»ç»Ÿ</p><div class="language-2. line-numbers-mode" data-ext="2."><pre class="language-2."><code>js
// router/index.js
import { lazy, Suspense } from &#39;react&#39;
import { createBrowserRouter } from &#39;react-router-dom&#39;
import Home from &#39;../pages/home&#39;

const React18 = lazy(() =&gt;
  import(/* webpackChunkName: &quot;react18&quot; */ &#39;../pages/React18&#39;)
)
const Vue3 = lazy(() =&gt; import(/* webpackChunkName: &quot;vue3&quot; */ &#39;../pages/Vue3&#39;))

const router = createBrowserRouter([
  {
    path: &#39;/&#39;,
    element: &lt;Home /&gt;,
    errorElement: &lt;div&gt;404&lt;/div&gt;,
    children: [
      {
        path: &#39;react18&#39;,
        element: (
          &lt;Suspense fallback={&lt;div&gt;loading...&lt;/div&gt;}&gt;
            &lt;React18 /&gt;
          &lt;/Suspense&gt;
        ),
      },
      {
        path: &#39;vue3&#39;,
        element: (
          &lt;Suspense fallback={&lt;div&gt;loading...&lt;/div&gt;}&gt;
            &lt;Vue3 /&gt;
          &lt;/Suspense&gt;
        ),
      },
    ],
  },
])

export default router

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ã€ä¸»åº”ç”¨ã€‘è·¯ç”±ç³»ç»Ÿç›¸å…³ç»„ä»¶</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// react18
const React18 = () =&gt; {
  return (
    &lt;div&gt;
      &lt;micro-app
        name=&quot;react18&quot;
        url=&quot;http://localhost:3311/&quot;
        baseroute=&quot;/react18&quot;
      /&gt;
    &lt;/div&gt;
  )
}

export default React18

// vue3
const Vue3 = () =&gt; {
  return (
    &lt;div&gt;
      &lt;micro-app name=&quot;vue3&quot; url=&quot;http://localhost:3312/&quot; baseroute=&quot;/vue3&quot; /&gt;
    &lt;/div&gt;
  )
}

export default Vue3

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-reactã€‘è·¯ç”±ç³»ç»Ÿ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// router/index.js
import { createBrowserRouter } from &#39;react-router-dom&#39;
import { lazy, Suspense } from &#39;react&#39;
import Home from &#39;../pages/home&#39;

const About = lazy(() =&gt;
  import(/* webpackChunkName: &quot;about&quot; */ &#39;../pages/about&#39;)
)
const Detail = lazy(() =&gt;
  import(/* webpackChunkName: &quot;detail&quot; */ &#39;../pages/detail&#39;)
)

const router = createBrowserRouter(
  [
    {
      path: &#39;/&#39;,
      element: &lt;Home /&gt;,
      // è¿™é‡Œæ”¾ç½®è‡ªå·±çš„è·¯ç”±å³å¯
      children: [
        {
          path: &#39;/about&#39;,
          element: (
            &lt;Suspense fallback={&lt;div&gt;loading&lt;/div&gt;}&gt;
              &lt;About /&gt;
            &lt;/Suspense&gt;
          ),
        },
        {
          path: &#39;detail/:id&#39;,
          element: (
            &lt;Suspense fallback={&lt;div&gt;loading&lt;/div&gt;}&gt;
              &lt;Detail /&gt;
            &lt;/Suspense&gt;
          ),
        },
      ],
    },
  ],
  // æ³¨æ„æ­¤å¤„ä¸ºå¾®å‰ç«¯ä¾µå…¥æ€§ä¿®æ”¹
  {
    basename: window.__MICRO_APP_BASE_ROUTE__ || &#39;/&#39;,
  }
)

export default router

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-vue3ã€‘è·¯ç”±ç³»ç»Ÿ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import { createRouter, createWebHistory } from &#39;vue-router&#39;

const router = createRouter({
  // æ³¨æ„æ­¤å¤„ä¸ºå¾®å‰ç«¯ä¾µå…¥æ€§ä¿®æ”¹
  history: createWebHistory(
    window.__MICRO_APP_BASE_ROUTE__ || process.env.BASE_URL
  ),
  routes: [
    {
      path: &#39;/detail&#39;,
      name: &#39;detail&#39;,
      component: () =&gt; import(&#39;../pages/Detail.vue&#39;),
    },
    {
      path: &#39;/about&#39;,
      name: &#39;about&#39;,
      component: () =&gt; import(&#39;../pages/AboutView.vue&#39;),
    },
  ],
})

export default router

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-å¼•å…¥å¾®å‰ç«¯æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#_3-å¼•å…¥å¾®å‰ç«¯æ¡†æ¶" aria-hidden="true">#</a> 3. å¼•å…¥å¾®å‰ç«¯æ¡†æ¶</h3><p>ã€ä¸»åº”ç”¨ã€‘å…¥å£æ–‡ä»¶å¼•å…¥æ¡†æ¶</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// index.js
import microApp from &#39;@micro-zoe/micro-app&#39;

microApp.start()

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-å­åº”ç”¨è·¨åŸŸé—®é¢˜å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_4-å­åº”ç”¨è·¨åŸŸé—®é¢˜å¤„ç†" aria-hidden="true">#</a> 4. å­åº”ç”¨è·¨åŸŸé—®é¢˜å¤„ç†</h3><ol><li>ã€å­åº”ç”¨-reactã€‘ä¿®æ”¹package.json</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;react-app-rewired start&quot;,
  &quot;build&quot;: &quot;react-app-rewired build&quot;,
  &quot;test&quot;: &quot;react-app-rewired test&quot;,
  &quot;eject&quot;: &quot;react-scripts eject&quot;
},

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-reactã€‘æ ¹ç›®å½•ä¸‹æ·»åŠ  <code>config-overrides.js</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>const { overrideDevServer } = require(&#39;customize-cra&#39;)
module.exports = {
  devServer: overrideDevServer((config) =&gt; {
    return {
      ...config,
      headers: {
        &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
      },
    }
  }),
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-vueã€‘æ ¹ç›®å½•<code>vue.config.js</code>ä¸­æ·»åŠ é…ç½®</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>const { defineConfig } = require(&#39;@vue/cli-service&#39;)

module.exports = defineConfig({
  // ...
  devServer: {
    port: 3312,
    headers: {
      &#39;Access-Control-Allow-Origin&#39;: &#39;*&#39;,
    },
  },
})

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-å­åº”ç”¨è®¾ç½®publicpath" tabindex="-1"><a class="header-anchor" href="#_5-å­åº”ç”¨è®¾ç½®publicpath" aria-hidden="true">#</a> 5. å­åº”ç”¨è®¾ç½®publicPath</h3><ol><li>ã€å­åº”ç”¨-reactã€‘srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸º<code>public-path.js</code>çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) {
  // eslint-disable-next-line
  __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-reactã€‘å…¥å£æ–‡ä»¶çš„<code>æœ€é¡¶éƒ¨</code>å¼•å…¥<code>public-path.js</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// entry
import &#39;./public-path&#39;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>ã€å­åº”ç”¨-vueã€‘srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸º<code>public-path.js</code>çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ  åŒä¸Šè¿°<code>reactå­åº”ç”¨</code>ä¸­ç›¸åŒå†…å®¹</li><li>ã€å­åº”ç”¨-vueã€‘å…¥å£æ–‡ä»¶çš„<code>æœ€é¡¶éƒ¨</code>å¼•å…¥<code>public-path.js</code></li></ol><p>ğŸ·æç¤ºï¼š</p><p>åˆ°è¿™é‡Œå·²ç»å®Œæˆä¸€ä¸ªå¾®å‰ç«¯çš„åŸºæœ¬æ­å»ºå·¥ä½œï¼Œå±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7eb886713cf479ab52244b18e3d7c0c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt="basicdemo.gif"></p><p>æ•´ä¸ªæ¥å…¥è¿‡ç¨‹éå¸¸ç®€å•ï¼Œä¾µå…¥æ€§çš„æ“ä½œæ€»ç»“æœ‰ï¼š</p><ul><li>ä¸»åº”ç”¨ <ul><li><code>microApp.start()</code></li><li>æ·»åŠ å¾®åº”ç”¨çš„å®¹å™¨ç»„ä»¶</li><li>æ·»åŠ è·¯ç”±æŒ‡å‘è¿™ä¸ªå®¹å™¨ç»„ä»¶</li></ul></li><li>å¾®åº”ç”¨ <ul><li>ä¿®æ”¹ public-path</li><li>æ·»åŠ è·¨åŸŸè®¿é—®</li><li>è‡ªåŠ¨åˆ‡æ¢è·¯ç”±çš„ <code>basename</code></li></ul></li></ul>`,42),o={id:"æ•°æ®é€šä¿¡",tabindex:"-1"},b=e("a",{class:"header-anchor",href:"#æ•°æ®é€šä¿¡","aria-hidden":"true"},"#",-1),p={href:"https://link.juejin.cn/?target=https%3A%2F%2Fzeroing.jd.com%2Fdocs.html%23%2Fzh-cn%2Fdata",target:"_blank",rel:"noopener noreferrer"},g=l(`<h4 id="çˆ¶ä¼ å­" tabindex="-1"><a class="header-anchor" href="#çˆ¶ä¼ å­" aria-hidden="true">#</a> çˆ¶ä¼ å­</h4><ol><li><p>ã€ä¸»åº”ç”¨ã€‘ä¿®æ”¹è·¯ç”±</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>js
// router/index.js
import { lazy, Suspense } from &#39;react&#39;
import { createBrowserRouter } from &#39;react-router-dom&#39;
import Home from &#39;../pages/home&#39;

const React18 = lazy(() =&gt;
  import(/* webpackChunkName: &quot;react18&quot; */ &#39;../pages/React18&#39;)
)
const Vue3 = lazy(() =&gt; import(/* webpackChunkName: &quot;vue3&quot; */ &#39;../pages/Vue3&#39;))

const router = createBrowserRouter([
  {
    path: &#39;/*&#39;,
    element: &lt;Home /&gt;,
    errorElement: &lt;div&gt;404&lt;/div&gt;,
    children: [
      {
        path: &#39;react18/*&#39;,
        element: (
          &lt;Suspense fallback={&lt;div&gt;loading&lt;/div&gt;}&gt;
            &lt;React18 /&gt;
          &lt;/Suspense&gt;
        ),
      },
      {
        path: &#39;vue3/*&#39;,
        element: (
          &lt;Suspense fallback={&lt;div&gt;loading&lt;/div&gt;}&gt;
            &lt;Vue3 /&gt;
          &lt;/Suspense&gt;
        ),
      },
    ],
  },
])

export default router

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>ã€ä¸»åº”ç”¨ã€‘é¡µé¢ç»„ä»¶æ·»åŠ ä»¥ä¸‹å†…å®¹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// React18
const location = useLocation()

useEffect(() =&gt; {
  // ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­åº”ç”¨åç§°
  microApp.setData(&#39;react18&#39;, {
    path: location.pathname.replace(&#39;/react18&#39;, &#39;&#39;),
  })
}, [location.pathname])

// å…¶ä»–é¡µé¢ç»„ä»¶å°†ç›¸åº”ç¬¬ä¸€ä¸ªå‚æ•°å’Œè·¯ç”±è¿›è¡Œä¿®æ”¹å³å¯

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-reactã€‘åœ¨é¦–é¡µæ·»åŠ ç›‘å¬äº‹ä»¶å¹¶é‡å®šå‘è·¯ç”±</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>const navigate = useNavigate()

  useEffect(() =&gt; {
    function dataListener(data) {
      if (data.path) {
        navigate(data.path)
      }
    }
    if (window.__MICRO_APP_ENVIRONMENT__) {
      window.microApp.addDataListener(dataListener)
    }
    return () =&gt; {
      if (window.__MICRO_APP_ENVIRONMENT__) {
        // è§£ç»‘ç›‘å¬å‡½æ•°
        window.microApp.removeDataListener(dataListener)
        // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
        window.microApp.clearDataListener()
      }
    }
  }, [])

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€å­åº”ç”¨-vueã€‘åœ¨é¦–é¡µæ·»åŠ ç›‘å¬äº‹ä»¶å¹¶é‡å®šå‘è·¯ç”±</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mounted() {
  const router = useRouter()
  function dataListener(data) {
    if (data.path) {
      router.push(data.path)
    }
  }
  if (window.__MICRO_APP_ENVIRONMENT__) {
    window.microApp.addDataListener(dataListener)
  }
},
unmounted() {
  if (window.__MICRO_APP_ENVIRONMENT__) {
    // è§£ç»‘ç›‘å¬å‡½æ•°
    window.microApp.removeDataListener()
    // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
    window.microApp.clearDataListener()
  }
},

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å­ä¼ çˆ¶" tabindex="-1"><a class="header-anchor" href="#å­ä¼ çˆ¶" aria-hidden="true">#</a> å­ä¼ çˆ¶</h4><ol><li><p>ã€å­åº”ç”¨-reactã€‘ç›‘å¬è·¯ç”±æ”¹å˜</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// home/index.js
const location = useLocation()

useEffect(() =&gt; {
  if (window.microApp) {
    window.microApp.dispatch({
      path: location.pathname,
    })
  }
}, [location.pathname])

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€ä¸»åº”ç”¨ã€‘è·å–æ•°æ®å¹¶åšå‡ºå“åº”</p></li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>// home/index.js
const [selectedKeys, setSelectedKeys] = useState([])

useEffect(() =&gt; {
  function dataListener(data) {
    setSelectedKeys([\`/react18\${data.path}\`])
  }

  microApp.addDataListener(&#39;react18&#39;, dataListener)

  return () =&gt; {
    // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„å‡½æ•°
    microApp.removeDataListener(&#39;react18&#39;, dataListener)
    // æ¸…ç©ºæ‰€æœ‰ç›‘å¬appNameå­åº”ç”¨çš„å‡½æ•°
    microApp.clearDataListener(&#39;react18&#39;)
  }
}, [])

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­åº”ç”¨å‘é€æ•°æ®ç­‰æ“ä½œåŒç†ï¼Œè¿™é‡Œå°±ä¸åšæ¼”ç¤ºäº†ï¼Œå¯ç›´æ¥çœ‹æºç ~</p><p>å®Œæˆæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/848ab6e23862403a8f189558caf1f5e2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt="æ•°æ®é€šä¿¡.gif"></p>`,14);function h(_,f){const n=a("ExternalLinkIcon");return r(),v("div",null,[c,e("p",null,[i("MicroAppæ˜¯ä¸€æ¬¾ç”±äº¬ä¸œé›¶å”®ï¼Œå¹³å°å‰ç«¯å›¢é˜Ÿå‡ºå“çš„é«˜æ€§èƒ½ä½æˆæœ¬å¾®å‰ç«¯æ¡†æ¶ï¼Œæœ¬æ–‡ä¸ºMicroAppçš„ä½¿ç”¨åˆæ¢ï¼Œæ‚¨å¯ä»¥é€‰æ‹©é€šè¿‡ "),e("a",u,[i("å®˜æ–¹demo"),d(n)]),i(" è¿›è¡Œå¯¹æ¡†æ¶å…¨é¢äº†è§£ã€‚")]),m,e("h3",o,[b,i(),e("a",p,[i("æ•°æ®é€šä¿¡"),d(n)])]),g])}const w=s(t,[["render",h],["__file","microapp.html.vue"]]);export{w as default};
